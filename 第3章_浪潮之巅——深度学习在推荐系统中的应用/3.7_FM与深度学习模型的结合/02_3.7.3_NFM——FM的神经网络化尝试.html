
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>02_3.7.3_NFM——FM的神经网络化尝试</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css">
</head>
<body>
  <div class="container">
    <h1>02_3.7.3 NFM——FM的神经网络化尝试</h1>
<p>&quot;&quot;&quot;
Lecture: 第3章 浪潮之巅——深度学习在推荐系统中的应用/3.7 FM与深度学习模型的结合
Content: 02_3.7.3 NFM——FM的神经网络化尝试
&quot;&quot;&quot;</p>
<h3>3.7.3 NFM——FM的神经网络化尝试</h3>
<h4>1. 背景和动机</h4>
<p>在推荐系统中，Factorization Machine（FM）模型因其在捕捉特征交互方面的优势，得到了广泛应用。然而，FM模型主要处理的是二阶特征交互，无法有效扩展到更高阶的特征交互。为了克服这一限制，新加坡国立大学的研究人员在2017年提出了NFM（Neural Factorization Machine）模型，旨在通过神经网络的强大表达能力，提升FM模型在高阶特征交互中的表现。</p>
<h4>2. NFM模型概述</h4>
<p>NFM模型在FM模型的基础上，引入了神经网络，用更强大的函数替代FM中二阶隐向量内积的部分。具体而言，NFM模型的结构如图3-20所示，通过在Embedding层和多层神经网络之间加入特征交叉池化层（Bi-Interaction Pooling Layer），实现了特征交互的增强。</p>
<h4>3. 特征交叉池化层的作用</h4>
<p>特征交叉池化层是NFM模型的核心创新之一。假设$ Vx $是所有特征域的Embedding集合，那么特征交叉池化层的具体操作如下：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msub><mi>v</mi><mi>i</mi></msub><mo>⊙</mo><msub><mi>v</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">f(x) = \sum_{i=1}^n \sum_{j=i+1}^n v_i \odot v_j 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.6513970000000007em;"></span><span class="strut bottom" style="height:3.0651740000000007em;vertical-align:-1.4137769999999998em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span style="top:1.1776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol large-op mop">∑</span></span></span><span style="top:-1.2500050000000003em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mop op-limits"><span class="vlist"><span style="top:1.1776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mrel">=</span><span class="mord mathit">i</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000254801em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol large-op mop">∑</span></span></span><span style="top:-1.2500050000000005em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">⊙</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></p>
<p>其中，$ \odot $代表两个向量的元素积操作，即对应维相乘得到元素积向量。</p>
<p>通过对两两Embedding向量进行元素积操作，再对交叉特征向量取和，得到池化层的输出向量。这个输出向量随后输入上层的多层全连接神经网络，进行进一步的特征交叉。</p>
<h4>4. NFM模型的优势</h4>
<p>NFM模型相较于传统FM模型和Wide&amp;Deep模型，有以下几个显著优势：</p>
<ol>
<li><strong>增强的特征交互能力</strong>：通过特征交叉池化层，NFM模型能够捕捉到更高阶的特征交互信息，提升模型的表达能力。</li>
<li><strong>更强的非线性特征表示</strong>：神经网络的引入，使得模型能够拟合更复杂的非线性特征组合，适应更多样化的推荐场景。</li>
<li><strong>联合训练</strong>：NFM模型通过联合训练特征交叉池化层和多层神经网络，实现了特征表示和特征交互的有效优化。</li>
</ol>
<h4>5. 实验结果与分析</h4>
<p>通过在多个推荐任务中的实验验证，NFM模型在点击率预测、评分预测等任务中表现优异。具体实验结果表明，NFM模型在特征交互和泛化能力上显著优于传统的FM模型和Wide&amp;Deep模型。</p>
<h4>6. 总结</h4>
<p>NFM模型通过引入神经网络，对FM模型进行改进，提升了特征交互的能力和模型的非线性表示。其创新点在于特征交叉池化层的设计，能够有效捕捉高阶特征交互信息，显著提升了推荐系统的性能。NFM模型在理论上提供了新的思路，也在实际应用中展现了强大的性能优势。</p>

  </div>
  <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      renderMathInElement(document.body, {
        delimiters: [
          {left: "$$", right: "$$", display: true},
          {left: "$", right: "$", display: false},
          {left: "\(", right: "\)", display: false},
          {left: "\[", right: "\]", display: true}
        ]
      });
    });
  </script>
</body>
</html>
  