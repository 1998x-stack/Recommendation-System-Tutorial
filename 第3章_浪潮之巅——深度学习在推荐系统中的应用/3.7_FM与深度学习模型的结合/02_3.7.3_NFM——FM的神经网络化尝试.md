# 02_3.7.3 NFM——FM的神经网络化尝试

"""
Lecture: 第3章 浪潮之巅——深度学习在推荐系统中的应用/3.7 FM与深度学习模型的结合
Content: 02_3.7.3 NFM——FM的神经网络化尝试
"""

### 3.7.3 NFM——FM的神经网络化尝试

#### 1. 背景和动机
在推荐系统中，Factorization Machine（FM）模型因其在捕捉特征交互方面的优势，得到了广泛应用。然而，FM模型主要处理的是二阶特征交互，无法有效扩展到更高阶的特征交互。为了克服这一限制，新加坡国立大学的研究人员在2017年提出了NFM（Neural Factorization Machine）模型，旨在通过神经网络的强大表达能力，提升FM模型在高阶特征交互中的表现。

#### 2. NFM模型概述
NFM模型在FM模型的基础上，引入了神经网络，用更强大的函数替代FM中二阶隐向量内积的部分。具体而言，NFM模型的结构如图3-20所示，通过在Embedding层和多层神经网络之间加入特征交叉池化层（Bi-Interaction Pooling Layer），实现了特征交互的增强。

#### 3. 特征交叉池化层的作用
特征交叉池化层是NFM模型的核心创新之一。假设$ Vx $是所有特征域的Embedding集合，那么特征交叉池化层的具体操作如下：
$$ f(x) = \sum_{i=1}^n \sum_{j=i+1}^n v_i \odot v_j $$
其中，$ \odot $代表两个向量的元素积操作，即对应维相乘得到元素积向量。

通过对两两Embedding向量进行元素积操作，再对交叉特征向量取和，得到池化层的输出向量。这个输出向量随后输入上层的多层全连接神经网络，进行进一步的特征交叉。

#### 4. NFM模型的优势
NFM模型相较于传统FM模型和Wide&Deep模型，有以下几个显著优势：
1. **增强的特征交互能力**：通过特征交叉池化层，NFM模型能够捕捉到更高阶的特征交互信息，提升模型的表达能力。
2. **更强的非线性特征表示**：神经网络的引入，使得模型能够拟合更复杂的非线性特征组合，适应更多样化的推荐场景。
3. **联合训练**：NFM模型通过联合训练特征交叉池化层和多层神经网络，实现了特征表示和特征交互的有效优化。

#### 5. 实验结果与分析
通过在多个推荐任务中的实验验证，NFM模型在点击率预测、评分预测等任务中表现优异。具体实验结果表明，NFM模型在特征交互和泛化能力上显著优于传统的FM模型和Wide&Deep模型。

#### 6. 总结
NFM模型通过引入神经网络，对FM模型进行改进，提升了特征交互的能力和模型的非线性表示。其创新点在于特征交叉池化层的设计，能够有效捕捉高阶特征交互信息，显著提升了推荐系统的性能。NFM模型在理论上提供了新的思路，也在实际应用中展现了强大的性能优势。