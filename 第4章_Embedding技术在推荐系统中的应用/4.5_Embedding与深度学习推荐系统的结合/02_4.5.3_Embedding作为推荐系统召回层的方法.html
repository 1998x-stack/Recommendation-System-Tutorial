
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>02_4.5.3_Embedding作为推荐系统召回层的方法</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css">
</head>
<body>
  <div class="container">
    <h1>02_4.5.3 Embedding作为推荐系统召回层的方法</h1>
<p>&quot;&quot;&quot;
Lecture: 第4章 Embedding技术在推荐系统中的应用/4.5 Embedding与深度学习推荐系统的结合
Content: 02_4.5.3 Embedding作为推荐系统召回层的方法
&quot;&quot;&quot;</p>
<h3>4.5.3 Embedding作为推荐系统召回层的方法</h3>
<h4>背景与概述</h4>
<p>在推荐系统中，召回阶段的主要任务是从海量的候选集（通常为数百万级）中快速筛选出用户可能感兴趣的一小部分候选项（数百到数千级），以供排序阶段进行精细排序。Embedding技术凭借其强大的特征表示能力和计算效率，在召回阶段得到了广泛应用。尤其是Embedding向量的相似性计算，可以高效地实现用户和物品的匹配，从而大大提升推荐系统的性能和效率。</p>
<h4>方法原理</h4>
<p>Embedding作为推荐系统召回层的方法，主要利用Embedding向量的相似性来进行候选物品的召回。具体步骤如下：</p>
<ol>
<li><strong>特征Embedding</strong>：通过预训练的Embedding模型，将用户和物品的高维稀疏特征向量转换为低维稠密特征向量。</li>
<li><strong>用户和物品的Embedding计算</strong>：对于每个用户，根据其行为数据（如观看历史、搜索记录等），计算用户的Embedding向量。同样，对于每个物品，根据其属性信息，计算物品的Embedding向量。</li>
<li><strong>相似性计算</strong>：利用用户Embedding向量和物品Embedding向量之间的相似性（如内积或余弦相似度），快速筛选出与用户最相似的物品作为候选集。</li>
</ol>
<h4>实际应用</h4>
<h5>YouTube推荐系统的召回层</h5>
<p>YouTube推荐系统是Embedding作为召回层的经典应用案例。其基本结构如图4-14所示：</p>
<ol>
<li><strong>输入层</strong>：用户观看历史视频的Embedding向量、用户搜索词Embedding向量、用户地理属性特征Embedding向量、用户年龄、性别等特征。</li>
<li><strong>隐藏层</strong>：经过三层ReLU全连接层，生成用户Embedding向量。</li>
<li><strong>输出层</strong>：通过softmax层，预测用户可能观看的视频类别。softmax层的输入是用户Embedding向量，输出是每个视频的概率分布。输出向量的每一维对应一个视频，该维对应的softmax层列向量就是物品的Embedding向量。</li>
</ol>
<p>通过模型的离线训练，可以最终得到每个用户的Embedding向量和物品的Embedding向量。在实际部署过程中，只需将用户Embedding和物品Embedding存储到线上内存数据库，通过内积运算再排序的方法就可以得到物品的排序，取序列中Top N的物品即可得到召回的候选集合。</p>
<h4>优势与局限性</h4>
<p><strong>优势</strong>：</p>
<ol>
<li><strong>高效性</strong>：通过Embedding向量的相似性计算，可以快速筛选出候选物品，大大减少了计算时间。</li>
<li><strong>灵活性</strong>：Embedding方法可以灵活地融合多种用户和物品特征，提高召回的准确性和多样性。</li>
<li><strong>连续性评分</strong>：Embedding召回可以提供连续的相似度评分，相比多路召回中不同策略的评分更具一致性和可比性。</li>
</ol>
<p><strong>局限性</strong>：</p>
<ol>
<li><strong>计算开销</strong>：在整体候选集达到百万级别的情况下，即使是O（n）级别的内积运算也会消耗大量计算资源，可能导致线上推断过程的延迟。</li>
<li><strong>依赖Embedding质量</strong>：Embedding向量的质量直接影响召回效果，如果预训练的Embedding不够准确或不包含足够的信息，召回效果会受到影响。</li>
</ol>
<h4>结论</h4>
<p>Embedding作为推荐系统召回层的方法，通过高效的相似性计算实现了用户和物品的快速匹配，显著提升了推荐系统的性能和效率。在实际应用中，通过优化Embedding的质量和计算方法，可以进一步提高召回的准确性和速度，是推荐系统召回层的重要技术手段。</p>

  </div>
  <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      renderMathInElement(document.body, {
        delimiters: [
          {left: "$$", right: "$$", display: true},
          {left: "$", right: "$", display: false},
          {left: "\(", right: "\)", display: false},
          {left: "\[", right: "\]", display: true}
        ]
      });
    });
  </script>
</body>
</html>
  